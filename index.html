<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c1{background-color:#f0f4f9;padding-top:0pt;padding-bottom:0pt;line-height:1.3571428571428572;orphans:2;widows:2;text-align:left}.c19{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c10{color:#5f6368;text-decoration:none;vertical-align:baseline;font-style:normal}.c4{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c0{font-size:10.5pt;font-family:"Courier New";color:#0000ff;font-weight:400}.c3{color:#383838;text-decoration:none;vertical-align:baseline;font-style:normal}.c14{color:#808080;text-decoration:none;vertical-align:baseline;font-style:normal}.c2{font-size:10.5pt;font-weight:400;font-family:"Courier New"}.c13{font-weight:400;font-size:11pt;font-family:"Arial"}.c16{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c9{color:#ff0000}.c12{color:#098658}.c15{color:#188038}.c7{height:11pt}.c6{color:#383838}.c18{color:#808080}.c5{color:#800000}.c8{color:#8430ce}.c17{color:#5f6368}.c11{color:#0451a5}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c16 doc-content"><p class="c1"><span class="c2 c18">&lt;!DOCTYPE</span><span class="c2 c9">&nbsp;html</span><span class="c2 c14">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;</span><span class="c2 c5">html</span><span class="c2">&nbsp;</span><span class="c2 c9">lang</span><span class="c2 c6">=</span><span class="c0">&quot;id&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;</span><span class="c2 c5">head</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">meta</span><span class="c2">&nbsp;</span><span class="c2 c9">charset</span><span class="c2 c6">=</span><span class="c0">&quot;UTF-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">meta</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;viewport&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">content</span><span class="c2 c6">=</span><span class="c0">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">title</span><span class="c2 c6">&gt;</span><span class="c2">SIKEPO - SD Negeri 29 Terusan</span><span class="c2 c6">&lt;/</span><span class="c2 c5">title</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Tailwind CSS CDN --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdn.tailwindcss.com&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Font Inter --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">link</span><span class="c2">&nbsp;</span><span class="c2 c9">href</span><span class="c2 c6">=</span><span class="c0">&quot;https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">rel</span><span class="c2 c6">=</span><span class="c0">&quot;stylesheet&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Firebase SDK --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;module&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">// Firebase SDK imports</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c8">import</span><span class="c2">&nbsp;{ initializeApp } </span><span class="c2 c8">from</span><span class="c2">&nbsp;</span><span class="c2 c15">&quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js&quot;</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c8">import</span><span class="c2">&nbsp;{ getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } </span><span class="c2 c8">from</span><span class="c2">&nbsp;</span><span class="c2 c15">&quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js&quot;</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c8">import</span><span class="c2">&nbsp;{ getFirestore, doc, getDoc, setDoc, collection, query, getDocs, onSnapshot } </span><span class="c2 c8">from</span><span class="c2">&nbsp;</span><span class="c2 c15">&quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js&quot;</span><span class="c4 c2">;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">// SheetJS (XLSX) for Excel export</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">// Note: This script is loaded globally, not via module import for simplicity in this context.</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c17">// &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js&quot;&gt;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Chart.js for graphs</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Note: This script is loaded globally, not via module import for simplicity in this context.</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;// </span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Global variables for Firebase instances</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.firebaseApp = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.db = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.auth = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.currentUserId = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.isAuthReady = false; // Flag to indicate if auth state has been checked</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Student data as provided</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;const studentsData = [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ABDAN SOLEH&quot;, nis: &quot;3155615150&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ABWABUN RIZKI&quot;, nis: &quot;3148664987&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ADIF AZKA&quot;, nis: &quot;3146898877&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ADIFA JUNIANTI&quot;, nis: &quot;3170212098&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ADILA AZZAHRA&quot;, nis: &quot;3167162045&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AFIF FIRDAUS&quot;, nis: &quot;0131954800&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AFIF MUZAFFAR&quot;, nis: &quot;3187554772&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AGRI HAFNI&quot;, nis: &quot;0134793526&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AGUS SAPUTRA&quot;, nis: &quot;0148563774&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHDA MAUZA&quot;, nis: &quot;3186214123&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHMAD SAKHA ARKAN&quot;, nis: &quot;3172129181&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHNAF AL HASIBY&quot;, nis: &quot;3172736587&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHZA AL ISLAMI&quot;, nis: &quot;3160386276&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AISH FAIHA&quot;, nis: &quot;0145102207&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AISYA ALIFA&quot;, nis: &quot;3161725174&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AKHDAN LATIF AZIZAN&quot;, nis: &quot;3169324065&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AKIFAH NAILAH&quot;, nis: &quot;3139266708&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AL PARISI&quot;, nis: &quot;0135602946&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALESYA ELVINA&quot;, nis: &quot;0136852252&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALFIAN RIZKI&quot;, nis: &quot;0149119772&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALIF GUPRON&quot;, nis: &quot;3125091343&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALIFA ADH ZAHRA&quot;, nis: &quot;3167573346&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALIIFA TAQIYYA&quot;, nis: &quot;3166370087&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALL ISTIQOMAH&quot;, nis: &quot;3179981696&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANDIKA SAPUTRA&quot;, nis: &quot;3131298133&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANDRA FATHIR AR&#39;ASHYID&quot;, nis: &quot;3144183317&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANDRA PRAYUDA&quot;, nis: &quot;3173084319&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANIN DITA&quot;, nis: &quot;0143402086&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANISA SHAKILAH&quot;, nis: &quot;3166006738&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANNISA NURUL AINI&quot;, nis: &quot;3126797487&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANNISAH SABILA&quot;, nis: &quot;0141894597&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AQILLA AYU KENZIA&quot;, nis: &quot;3137369360&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARIDHAH ZAHIRA&quot;, nis: &quot;3166770016&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARIF DZAKI&quot;, nis: &quot;3158368653&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARISTA ADINDA ZAHRA&quot;, nis: &quot;3165731254&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARKANA IBNU HAPIZ&quot;, nis: &quot;3186966980&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARSAKHA FIRENDRA&quot;, nis: &quot;0163124882&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ASIMA RASYIDAH&quot;, nis: &quot;3171656903&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ASSYIFA WAROHMAH&quot;, nis: &quot;0145559875&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ASYIFA&quot;, nis: &quot;3132084012&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ATHIFAH NAJIBAH&quot;, nis: &quot;3141575137&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AYUDIA INARA&quot;, nis: &quot;3166989578&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZALEA RAMADANI&quot;, nis: &quot;3183666209&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZAM SAPUTRA&quot;, nis: &quot;3163535253&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKA AMANI&quot;, nis: &quot;3127394232&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKA NANDANA&quot;, nis: &quot;3171828078&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKADINA SYAHIRA&quot;, nis: &quot;3186616578&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKIA FITRI&quot;, nis: &quot;0137269167&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZZAHDAN&quot;, nis: &quot;0147437017&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZZAHRA&quot;, nis: &quot;3164580221&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZZAHRA MALIKATUNNISA&quot;, nis: &quot;0142606608&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;BILQIS ADIBA&quot;, nis: &quot;3148467992&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DAHLIA SAFITRI&quot;, nis: &quot;0155421876&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DARYL GIBRAN&quot;, nis: &quot;3177105635&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DHAFI ALFARIZKI&quot;, nis: &quot;3189107763&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DHIRA ERIANI EFENDI&quot;, nis: &quot;0136193837&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;EL HILAL&quot;, nis: &quot;0149878379&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FAJAR HIBATULLAH&quot;, nis: &quot;3147853995&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FAQIH AL-ARIF BILLAH&quot;, nis: &quot;0162980888&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FARID ABDULLAH&quot;, nis: &quot;3159849454&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FARID ATALLAH&quot;, nis: &quot;3173213699&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FATUR HAERYAN&quot;, nis: &quot;3189477950&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FEBRI YANTA&quot;, nis: &quot;0148382960&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIDIA ZAHIRA&quot;, nis: &quot;3175219013&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIKA APRILIA PUTERI&quot;, nis: &quot;3162193153&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIKRI&quot;, nis: &quot;3154327861&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIKRI ADITIYA ZAIDAN&quot;, nis: &quot;3176698051&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIRJATULLAH&quot;, nis: &quot;3170009430&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HABIBAH NUR AINI&quot;, nis: &quot;3156544031&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HADZIQ PIKRI&quot;, nis: &quot;3133282159&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HANA KHAIRUNNISA&quot;, nis: &quot;3152019771&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HAPIZA HOYIRO&quot;, nis: &quot;3150397264&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HESTYAN PUSPITA NINGRUM&quot;, nis: &quot;3176737868&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HILYA QONITA&quot;, nis: &quot;3140539807&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ILDAH HIJRIAH&quot;, nis: &quot;3129581253&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ILONA WANIA ALSABA&quot;, nis: &quot;3182740868&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IMAM ALHAFID&quot;, nis: &quot;0161714082&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;INTAN AYU DISKA&quot;, nis: &quot;3170849022&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;INTAN MAHARANI&quot;, nis: &quot;3167437812&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IQBAL ARKAP&quot;, nis: &quot;3153337033&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IQBAL RAMADHAN&quot;, nis: &quot;0125999247&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IRFAN YUSRAN ADITYA&quot;, nis: &quot;0146514349&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ISTIQOMAH&quot;, nis: &quot;0122591444&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IZATUNNISA&quot;, nis: &quot;3136662150&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IZZAH URRUH&quot;, nis: &quot;0147611643&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;JANATAN FIRDAUS&quot;, nis: &quot;3178698209&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;JANEETA RAISSA&quot;, nis: &quot;0145100679&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KAYLA AFIFAH&quot;, nis: &quot;0135204738&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KAYLA SAPINA&quot;, nis: &quot;0134359075&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KENZIE ABDILLAH&quot;, nis: &quot;3161203638&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KEVIN AFFANDI&quot;, nis: &quot;3156543397&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KHOIRIL ANAM&quot;, nis: &quot;0123179238&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KHOIRUNNISA&quot;, nis: &quot;3144391116&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;LIA ZAFIRA&quot;, nis: &quot;0122048375&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M IRZAH KHOIRULLAH&quot;, nis: &quot;0147327198&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M RAFI MAULANA&quot;, nis: &quot;3171271070&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ABID AUFA&quot;, nis: &quot;0149957978&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. AKIL&quot;, nis: &quot;0133853164&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. AL HABSYI&quot;, nis: &quot;3179846316&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ALBY FAHRI&quot;, nis: &quot;0142513224&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ALFAJRI&quot;, nis: &quot;0132059947&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. HABIBIE&quot;, nis: &quot;3154655615&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. Nahtor Nabil&quot;, nis: &quot;0132087512&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. NIZAM&quot;, nis: &quot;3165316803&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. RAFA&quot;, nis: &quot;3165882318&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. RAFFA ALFARIZQI&quot;, nis: &quot;3131445988&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. RAFI RAFFASYA&quot;, nis: &quot;0155850169&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. SAKHA ABDILLAH&quot;, nis: &quot;3133790004&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ZHAFRAN KHAIRI&quot;, nis: &quot;0139386311&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M.IBNU ALNAFIS&quot;, nis: &quot;3179454907&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;MAIRA AZZAH&quot;, nis: &quot;UNKNOWN_NIS_MAIRA&quot;, class: &quot;UNKNOWN_CLASS_MAIRA&quot; } // Placeholder for incomplete data</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;];</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Homeroom teacher data</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;const teachersData = [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 6&quot;, wali: &quot;Almuttahidin&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 5 A&quot;, wali: &quot;Risnawati&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 5 B&quot;, wali: &quot;Eny Marya&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 4 A&quot;, wali: &quot;Mariatul Kibtiya&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 4 B&quot;, wali: &quot;Zaharudin&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 3 A&quot;, wali: &quot;Siti Nursiyah&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 3 B&quot;, wali: &quot;Rita Ummatun&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 2 A&quot;, wali: &quot;Roziko&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 2 B&quot;, wali: &quot;Ambari&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 1 A&quot;, wali: &quot;Asniar&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 1 B&quot;, wali: &quot;Marfuah&quot; }</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;];</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Get unique classes from student data and sort them</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.classes = [...new Set(studentsData.map(s =&gt; s.class))].sort();</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Initialize Firebase</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.addEventListener(&#39;load&#39;, async () =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const firebaseConfig = typeof __firebase_config !5= &#39;undefined&#39; ? JSON.parse(__firebase_config) : {};</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (Object.keys(firebaseConfig).length === 0) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Firebase config is missing. Please ensure __firebase_config is provided.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-message&#39;).textContent = &quot;Kesalahan: Konfigurasi Firebase tidak ditemukan. Aplikasi tidak dapat dimuat.&quot;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.firebaseApp = initializeApp(firebaseConfig);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.db = getFirestore(window.firebaseApp);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.auth = getAuth(window.firebaseApp);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Authenticate user</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (typeof __initial_auth_token !== &#39;undefined&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInWithCustomToken(window.auth, __initial_auth_token);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInAnonymously(window.auth);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Listen for auth state changes</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;onAuthStateChanged(window.auth, async (user) =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (user) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.currentUserId = user.uid;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;user-id-display&#39;).textContent = `ID Pengguna: ${window.currentUserId}`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.isAuthReady = true;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Firebase initialized and authenticated. User ID:&quot;, window.currentUserId);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await initAppData(); // Initialize app data (students, teachers) after auth</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showSection(&#39;attendance-input-section&#39;); // Show default section</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-overlay&#39;).classList.add(&#39;hidden&#39;); // Hide loading</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.currentUserId = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.isAuthReady = true;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;user-id-display&#39;).textContent = `ID Pengguna: Tidak Terautentikasi`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Firebase initialized, but no user authenticated.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-message&#39;).textContent = &quot;Kesalahan: Autentikasi Firebase gagal. Aplikasi tidak dapat dimuat.&quot;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error initializing Firebase:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-message&#39;).textContent = `Kesalahan saat memulai aplikasi: ${error.message}.`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Function to initialize app data (students and teachers) in Firestore</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function initAppData() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!window.isAuthReady || !window.db) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.warn(&quot;Firebase not ready for data initialization.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsColRef = collection(window.db, `artifacts/${appId}/public/data/students`);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const teachersColRef = collection(window.db, `artifacts/${appId}/public/data/teachers`);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Check if students data exists, if not, add it</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsSnapshot = await getDocs(studentsColRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (studentsSnapshot.empty) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Adding initial student data to Firestore...&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const student of studentsData) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(doc(studentsColRef, student.nis), student);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Student data added.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Student data already exists in Firestore.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Check if teachers data exists, if not, add it</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const teachersSnapshot = await getDocs(teachersColRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (teachersSnapshot.empty) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Adding initial teacher data to Firestore...&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const teacher of teachersData) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(doc(teachersColRef, teacher.class), teacher);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Teacher data added.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Teacher data already exists in Firestore.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Load students and teachers into global variables for faster access</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.allStudents = studentsData; // Use the parsed data directly</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.allTeachers = teachersData; // Use the parsed data directly</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;populateClassDropdowns();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error initializing app data:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- UI Navigation Functions ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function showSection(sectionId) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;.app-section&#39;).forEach(section =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;section.classList.add(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(sectionId).classList.remove(&#39;hidden&#39;);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Update active navigation link</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;nav a&#39;).forEach(link =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.classList.remove(&#39;bg-blue-700&#39;, &#39;text-white&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.classList.add(&#39;text-blue-200&#39;, &#39;hover:bg-blue-600&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelector(`nav a[onclick=&quot;showSection(&#39;${sectionId}&#39;)&quot;]`).classList.remove(&#39;text-blue-200&#39;, &#39;hover:bg-blue-600&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelector(`nav a[onclick=&quot;showSection(&#39;${sectionId}&#39;)&quot;]`).classList.add(&#39;bg-blue-700&#39;, &#39;text-white&#39;);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Specific actions for sections</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (sectionId === &#39;recapitulation-section&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;renderRecap();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Attendance Input Logic ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function populateClassDropdowns() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const classSelect = document.getElementById(&#39;attendance-class-select&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recapClassSelect = document.getElementById(&#39;recap-class-select&#39;);</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;classSelect.innerHTML = &#39;</span><span class="c2 c6">&lt;</span><span class="c2 c5">option</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Kelas</span><span class="c2 c6">&lt;/</span><span class="c2 c5">option</span><span class="c2 c6">&gt;</span><span class="c4 c2">&#39;;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapClassSelect.innerHTML = &#39;</span><span class="c2 c6">&lt;</span><span class="c2 c5">option</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Semua Kelas</span><span class="c2 c6">&lt;/</span><span class="c2 c5">option</span><span class="c2 c6">&gt;</span><span class="c4 c2">&#39;; // For recapitulation, allow &quot;All Classes&quot;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.classes.forEach(cls =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const option = document.createElement(&#39;option&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;option.value = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;option.textContent = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;classSelect.appendChild(option);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recapOption = document.createElement(&#39;option&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapOption.value = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapOption.textContent = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapClassSelect.appendChild(recapOption);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function loadStudentsForAttendance() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;attendance-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedDate = document.getElementById(&#39;attendance-date-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceTableBody = document.getElementById(&#39;attendance-table-body&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attendanceTableBody.innerHTML = &#39;&#39;; // Clear previous students</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedClass || !selectedDate) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsInClass = window.allStudents.filter(s =&gt; s.class === selectedClass);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocId = `${selectedDate}_${selectedClass.replace(/\s/g, &#39;_&#39;)}`; // Use underscore for class name in doc ID</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocRef = doc(window.db, `artifacts/${appId}/public/data/attendance`, attendanceDocId);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let existingAttendance = {};</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const docSnap = await getDoc(attendanceDocRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (docSnap.exists()) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;existingAttendance = docSnap.data().records.reduce((acc, rec) =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;acc[rec.nis] = rec.status;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return acc;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, {});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error fetching existing attendance:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentsInClass.forEach(student =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const row = document.createElement(&#39;tr&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.className = &#39;border-b border-gray-200&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const currentStatus = existingAttendance[student.nis] || &#39;Hadir&#39;; // Default to Hadir</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.innerHTML = `</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${student.name}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex items-center space-x-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Hadir&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-blue-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Hadir&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Hadir</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Sakit&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-yellow-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Sakit&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Sakit</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Izin&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-green-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Izin&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Izin</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Alpha&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-red-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Alpha&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Alpha</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attendanceTableBody.appendChild(row);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;save-attendance-btn&#39;).classList.remove(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function saveAttendance() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;attendance-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedDate = document.getElementById(&#39;attendance-date-input&#39;).value;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedClass || !selectedDate) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Pilih kelas dan tanggal terlebih dahulu.&#39;, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceRecords = [];</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsInClass = window.allStudents.filter(s =&gt; s.class === selectedClass);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentsInClass.forEach(student =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const statusElement = document.querySelector(`input[name=&quot;status-${student.nis}&quot;]:checked`);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (statusElement) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attendanceRecords.push({</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nis: student.nis,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name: student.name, // Store name for easier lookup in reports</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;status: statusElement.value</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocId = `${selectedDate}_${selectedClass.replace(/\s/g, &#39;_&#39;)}`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocRef = doc(window.db, `artifacts/${appId}/public/data/attendance`, attendanceDocId);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(attendanceDocRef, {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;date: selectedDate,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class: selectedClass,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;records: attendanceRecords</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Kehadiran berhasil disimpan!&#39;, &#39;success&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error saving attendance:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(`Gagal menyimpan kehadiran: ${error.message}`, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Recapitulation Logic ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;let myChart = null; // To store the Chart.js instance</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function renderRecap() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedMonthYear = document.getElementById(&#39;recap-month-year-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;recap-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recapTableBody = document.getElementById(&#39;recap-table-body&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const chartCanvas = document.getElementById(&#39;attendanceChart&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapTableBody.innerHTML = &#39;&#39;;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedMonthYear) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Pilih bulan dan tahun untuk rekapitulasi.&#39;, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const [year, month] = selectedMonthYear.split(&#39;-&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const firstDay = new Date(year, month - 1, 1);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const lastDay = new Date(year, month, 0); // Last day of the month</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceColRef = collection(window.db, `artifacts/${appId}/public/data/attendance`);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let allAttendanceRecords = [];</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const querySnapshot = await getDocs(attendanceColRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;querySnapshot.forEach(docSnap =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const data = docSnap.data();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recordDate = new Date(data.date);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Filter by month and year</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (recordDate &gt;= firstDay &amp;&amp; recordDate </span><span class="c2 c6">&lt;</span><span class="c4 c2">= lastDay) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Filter by class if a specific class is selected</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedClass || data.class === selectedClass) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;allAttendanceRecords.push(data);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error fetching recapitulation data:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(`Gagal memuat data rekapitulasi: ${error.message}`, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Aggregate data</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentRecap = {}; // { nis: { name, class, Hadir: count, Sakit: count, Izin: count, Alpha: count } }</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Initialize studentRecap with all relevant students</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsToProcess = selectedClass ?</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.allStudents.filter(s =&gt; s.class === selectedClass) :</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.allStudents;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentsToProcess.forEach(student =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentRecap[student.nis] = {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name: student.name,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class: student.class,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Hadir&#39;: 0,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Sakit&#39;: 0,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Izin&#39;: 0,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Alpha&#39;: 0</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;allAttendanceRecords.forEach(dailyRecord =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dailyRecord.records.forEach(studentDailyRecord =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (studentRecap[studentDailyRecord.nis]) { // Only count if student is in the processed list</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentRecap[studentDailyRecord.nis][studentDailyRecord.status]++;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Render table</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const nis in studentRecap) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const data = studentRecap[nis];</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const row = document.createElement(&#39;tr&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.className = &#39;border-b border-gray-200&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.innerHTML = `</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.name}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.class}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Hadir}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Sakit}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Izin}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Alpha}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapTableBody.appendChild(row);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Render chart</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;renderChart(studentRecap);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Enable download buttons</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;download-excel-btn&#39;).classList.remove(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;download-csv-btn&#39;).classList.remove(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function renderChart(recapData) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const chartCanvas = document.getElementById(&#39;attendanceChart&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (myChart) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;myChart.destroy(); // Destroy existing chart before creating a new one</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const hadirCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Hadir, 0);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const sakitCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Sakit, 0);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const izinCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Izin, 0);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const alphaCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Alpha, 0);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;myChart = new Chart(chartCanvas, {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type: &#39;bar&#39;, // Can be &#39;bar&#39;, &#39;pie&#39;, &#39;doughnut&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;data: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;labels: [&#39;Hadir&#39;, &#39;Sakit&#39;, &#39;Izin&#39;, &#39;Alpha&#39;],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;datasets: [{</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;label: &#39;Jumlah Kehadiran&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;data: [hadirCount, sakitCount, izinCount, alphaCount],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;backgroundColor: [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(75, 192, 192, 0.6)&#39;, // Hadir</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 206, 86, 0.6)&#39;, // Sakit</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(54, 162, 235, 0.6)&#39;, // Izin</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 99, 132, 0.6)&#39; &nbsp;// Alpha</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;borderColor: [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(75, 192, 192, 1)&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 206, 86, 1)&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(54, 162, 235, 1)&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 99, 132, 1)&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;borderWidth: 1</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}]</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;options: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;responsive: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;maintainAspectRatio: false,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;scales: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;y: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beginAtZero: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39;Jumlah Catatan Kehadiran&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;plugins: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39;Ringkasan Kehadiran Bulanan&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Export Functions ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function exportToExcel() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedMonthYear = document.getElementById(&#39;recap-month-year-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;recap-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const filename = `Rekap_Kehadiran_SDN29Terusan_${selectedClass || &#39;SemuaKelas&#39;}_${selectedMonthYear}.xlsx`;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const table = document.getElementById(&#39;recap-table&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const ws = XLSX.utils.table_to_sheet(table);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const wb = XLSX.utils.book_new();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;XLSX.utils.book_append_sheet(wb, ws, &quot;Rekap Kehadiran&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;XLSX.writeFile(wb, filename);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Laporan Excel berhasil diunduh!&#39;, &#39;success&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function exportToCSV() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedMonthYear = document.getElementById(&#39;recap-month-year-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;recap-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const filename = `Rekap_Kehadiran_SDN29Terusan_${selectedClass || &#39;SemuaKelas&#39;}_${selectedMonthYear}.csv`;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const table = document.getElementById(&#39;recap-table&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let csv = [];</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (let i = 0; i </span><span class="c2 c6">&lt;</span><span class="c4 c2">&nbsp;table.rows.length; i++) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let row = [], cols = table.rows[i].querySelectorAll(&#39;td, th&#39;);</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (let j = 0; j </span><span class="c2 c6">&lt;</span><span class="c4 c2">&nbsp;cols.length; j++) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.push(cols[j].innerText);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;csv.push(row.join(&#39;,&#39;));</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const csvFile = new Blob([csv.join(&#39;\n&#39;)], { type: &#39;text/csv;charset=utf-8;&#39; });</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const downloadLink = document.createElement(&#39;a&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;downloadLink.href = URL.createObjectURL(csvFile);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;downloadLink.download = filename;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.body.appendChild(downloadLink);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;downloadLink.click();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.body.removeChild(downloadLink);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Laporan CSV berhasil diunduh!&#39;, &#39;success&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Message Box / Toast Notification ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function showMessage(message, type) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const messageBox = document.getElementById(&#39;message-box&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.textContent = message;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.remove(&#39;hidden&#39;, &#39;bg-green-100&#39;, &#39;text-green-800&#39;, &#39;bg-red-100&#39;, &#39;text-red-800&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (type === &#39;success&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.add(&#39;bg-green-100&#39;, &#39;text-green-800&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else if (type === &#39;error&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.add(&#39;bg-red-100&#39;, &#39;text-red-800&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setTimeout(() =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.add(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, 3000); // Hide after 3 seconds</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Expose functions to global scope for HTML event handlers</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.showSection = showSection;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.loadStudentsForAttendance = loadStudentsForAttendance;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.saveAttendance = saveAttendance;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.renderRecap = renderRecap;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.exportToExcel = exportToExcel;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.exportToCSV = exportToCSV;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">style</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">body</span><span class="c4 c2">&nbsp;{</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">font-family:</span><span class="c2">&nbsp;</span><span class="c2 c15">&#39;Inter&#39;</span><span class="c2">, </span><span class="c2 c11">sans-serif</span><span class="c4 c2">;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">/* Custom styles for better radio button alignment */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio</span><span class="c4 c2">&nbsp;{</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">-webkit-appearance:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">-moz-appearance:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">appearance:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">display:</span><span class="c2">&nbsp;</span><span class="c2 c11">inline-block</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">vertical-align:</span><span class="c2">&nbsp;</span><span class="c2 c11">middle</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-origin:</span><span class="c2">&nbsp;</span><span class="c2 c11">border-box</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">user-select:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">flex-shrink:</span><span class="c2">&nbsp;</span><span class="c2 c12">0</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">border-radius:</span><span class="c2">&nbsp;</span><span class="c2 c12">100%</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">border-width:</span><span class="c2">&nbsp;</span><span class="c2 c12">1px</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">border-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#cbd5e0</span><span class="c2">; </span><span class="c10 c2">/* gray-300 */</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio:checked</span><span class="c4 c2">&nbsp;{</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-image:</span><span class="c2">&nbsp;</span><span class="c2 c11">url</span><span class="c2">(</span><span class="c2 c15">&quot;data:image/svg+xml,%3csvg viewBox=&#39;0 0 16 16&#39; fill=&#39;white&#39; xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3ccircle cx=&#39;8&#39; cy=&#39;8&#39; r=&#39;3&#39;/%3e%3c/svg%3e&quot;</span><span class="c4 c2">);</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-size:</span><span class="c2">&nbsp;</span><span class="c2 c12">100%</span><span class="c2">&nbsp;</span><span class="c2 c12">100%</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-position:</span><span class="c2">&nbsp;</span><span class="c2 c11">center</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-repeat:</span><span class="c2">&nbsp;</span><span class="c2 c11">no-repeat</span><span class="c4 c2">;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-blue-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#2563eb</span><span class="c2">; } </span><span class="c10 c2">/* blue-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-yellow-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#d97706</span><span class="c2">; } </span><span class="c10 c2">/* yellow-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-green-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#059669</span><span class="c2">; } </span><span class="c10 c2">/* green-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-red-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#dc2626</span><span class="c2">; } </span><span class="c10 c2">/* red-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">style</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;/</span><span class="c2 c5">head</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;</span><span class="c2 c5">body</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-gray-100 text-gray-900 min-h-screen flex flex-col&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Loading Overlay --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;loading-overlay&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-white p-8 rounded-lg shadow-lg text-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent mx-auto mb-4&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">p</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;loading-message&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-lg font-semibold text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Memuat aplikasi...</span><span class="c2 c6">&lt;/</span><span class="c2 c5">p</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c10">&lt;!-- Message Box --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;message-box&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden fixed top-4 right-4 p-4 rounded-lg shadow-md text-sm font-medium z-40 transition-all duration-300 ease-in-out&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">header</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-800 text-white p-4 shadow-md flex items-center justify-between flex-wrap&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex items-center space-x-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">img</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://freeimghost.net/images/2025/06/13/MD-02-2.png&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">alt</span><span class="c2 c6">=</span><span class="c0">&quot;Logo SD Negeri 29 Terusan&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;h-12 w-12 rounded-full shadow-lg&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h1</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-2xl font-bold&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Sistem Informasi Kehadiran Pelajar Online (SIKEPO)</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h1</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-sm mt-2 md:mt-0&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;user-id-display&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">header</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex flex-1 flex-col md:flex-row&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Sidebar Navigation --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">nav</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-800 text-blue-200 w-full md:w-64 p-4 space-y-2 shadow-lg&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">a</span><span class="c2">&nbsp;</span><span class="c2 c9">href</span><span class="c2 c6">=</span><span class="c0">&quot;#&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;showSection(&#39;attendance-input-section&#39;)&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block p-3 rounded-lg hover:bg-blue-600 transition-colors duration-200 bg-blue-700 text-white&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Input Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">a</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">a</span><span class="c2">&nbsp;</span><span class="c2 c9">href</span><span class="c2 c6">=</span><span class="c0">&quot;#&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;showSection(&#39;recapitulation-section&#39;)&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block p-3 rounded-lg hover:bg-blue-600 transition-colors duration-200&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Rekapitulasi &amp; Laporan</span><span class="c2 c6">&lt;/</span><span class="c2 c5">a</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">nav</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Main Content Area --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">main</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex-1 p-6 bg-gray-50 overflow-auto&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Input Kehadiran Section --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">section</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-input-section&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;app-section bg-white p-6 rounded-lg shadow-xl mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h2</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-3xl font-semibold text-blue-800 mb-6&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Input Kehadiran Harian</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h2</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;grid grid-cols-1 md:grid-cols-2 gap-6 mb-6&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-date-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Tanggal:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;date&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-date-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;loadStudentsForAttendance()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Kelas:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">select</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;loadStudentsForAttendance()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Options will be populated by JavaScript --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">select</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;overflow-x-auto&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">table</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;min-w-full bg-white rounded-lg shadow-md&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">thead</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-100&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tl-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Nama Siswa</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tr-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Status Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">thead</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tbody</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-table-body&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Student rows will be loaded here --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tbody</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">table</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">button</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;save-attendance-btn&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;saveAttendance()&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden mt-6 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Simpan Kehadiran</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">button</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">section</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Rekapitulasi &amp; Laporan Section --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">section</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recapitulation-section&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;app-section hidden bg-white p-6 rounded-lg shadow-xl mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h2</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-3xl font-semibold text-blue-800 mb-6&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Rekapitulasi &amp; Laporan Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h2</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;grid grid-cols-1 md:grid-cols-2 gap-6 mb-6&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;recap-month-year-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Bulan &amp; Tahun:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;month&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-month-year-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;renderRecap()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;recap-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Kelas:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">select</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;renderRecap()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Options will be populated by JavaScript --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">select</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;overflow-x-auto mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">table</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-table&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;min-w-full bg-white rounded-lg shadow-md&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">thead</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-100&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tl-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Nama Siswa</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Kelas</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Hadir</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Sakit</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Izin</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tr-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Alpha</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">thead</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tbody</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-table-body&quot;</span><span class="c2 c3">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Recapitulation data will be loaded here --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tbody</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">table</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h3</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-2xl font-semibold text-blue-700 mb-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Grafik Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h3</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;relative h-80&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">canvas</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendanceChart&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">canvas</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex flex-wrap gap-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">button</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;download-excel-btn&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;exportToExcel()&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-75&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Download Excel</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">button</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">button</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;download-csv-btn&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;exportToCSV()&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-75&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Download Spreadsheet (CSV)</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">button</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">section</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">main</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">footer</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-gray-800 text-gray-300 p-4 text-center text-sm flex items-center justify-center flex-wrap&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;mr-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Powered by. Gena Belajar</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">img</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://freeimghost.net/images/2025/06/17/Logo-Gena-Belajar.png&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">alt</span></p><p class="c7 c19"><span class="c4 c13"></span></p><p class="c1"><span class="c2 c18">&lt;!DOCTYPE</span><span class="c2 c9">&nbsp;html</span><span class="c14 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;</span><span class="c2 c5">html</span><span class="c2">&nbsp;</span><span class="c2 c9">lang</span><span class="c2 c6">=</span><span class="c0">&quot;id&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;</span><span class="c2 c5">head</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">meta</span><span class="c2">&nbsp;</span><span class="c2 c9">charset</span><span class="c2 c6">=</span><span class="c0">&quot;UTF-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">meta</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;viewport&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">content</span><span class="c2 c6">=</span><span class="c0">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">title</span><span class="c2 c6">&gt;</span><span class="c2">SIKEPO - SD Negeri 29 Terusan</span><span class="c2 c6">&lt;/</span><span class="c2 c5">title</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Tailwind CSS CDN --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdn.tailwindcss.com&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Font Inter --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">link</span><span class="c2">&nbsp;</span><span class="c2 c9">href</span><span class="c2 c6">=</span><span class="c0">&quot;https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">rel</span><span class="c2 c6">=</span><span class="c0">&quot;stylesheet&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Firebase SDK --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;module&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">// Firebase SDK imports</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c8">import</span><span class="c2">&nbsp;{ initializeApp } </span><span class="c2 c8">from</span><span class="c2">&nbsp;</span><span class="c2 c15">&quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js&quot;</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c8">import</span><span class="c2">&nbsp;{ getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } </span><span class="c2 c8">from</span><span class="c2">&nbsp;</span><span class="c2 c15">&quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js&quot;</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c8">import</span><span class="c2">&nbsp;{ getFirestore, doc, getDoc, setDoc, collection, query, getDocs, onSnapshot } </span><span class="c2 c8">from</span><span class="c2">&nbsp;</span><span class="c2 c15">&quot;https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js&quot;</span><span class="c4 c2">;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">// SheetJS (XLSX) for Excel export</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">// Note: This script is loaded globally, not via module import for simplicity in this context.</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c17">// &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js&quot;&gt;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Chart.js for graphs</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Note: This script is loaded globally, not via module import for simplicity in this context.</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;// </span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Global variables for Firebase instances</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.firebaseApp = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.db = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.auth = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.currentUserId = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.isAuthReady = false; // Flag to indicate if auth state has been checked</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Student data as provided</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;const studentsData = [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ABDAN SOLEH&quot;, nis: &quot;3155615150&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ABWABUN RIZKI&quot;, nis: &quot;3148664987&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ADIF AZKA&quot;, nis: &quot;3146898877&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ADIFA JUNIANTI&quot;, nis: &quot;3170212098&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ADILA AZZAHRA&quot;, nis: &quot;3167162045&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AFIF FIRDAUS&quot;, nis: &quot;0131954800&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AFIF MUZAFFAR&quot;, nis: &quot;3187554772&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AGRI HAFNI&quot;, nis: &quot;0134793526&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AGUS SAPUTRA&quot;, nis: &quot;0148563774&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHDA MAUZA&quot;, nis: &quot;3186214123&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHMAD SAKHA ARKAN&quot;, nis: &quot;3172129181&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHNAF AL HASIBY&quot;, nis: &quot;3172736587&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AHZA AL ISLAMI&quot;, nis: &quot;3160386276&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AISH FAIHA&quot;, nis: &quot;0145102207&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AISYA ALIFA&quot;, nis: &quot;3161725174&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AKHDAN LATIF AZIZAN&quot;, nis: &quot;3169324065&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AKIFAH NAILAH&quot;, nis: &quot;3139266708&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AL PARISI&quot;, nis: &quot;0135602946&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALESYA ELVINA&quot;, nis: &quot;0136852252&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALFIAN RIZKI&quot;, nis: &quot;0149119772&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALIF GUPRON&quot;, nis: &quot;3125091343&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALIFA ADH ZAHRA&quot;, nis: &quot;3167573346&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALIIFA TAQIYYA&quot;, nis: &quot;3166370087&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ALL ISTIQOMAH&quot;, nis: &quot;3179981696&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANDIKA SAPUTRA&quot;, nis: &quot;3131298133&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANDRA FATHIR AR&#39;ASHYID&quot;, nis: &quot;3144183317&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANDRA PRAYUDA&quot;, nis: &quot;3173084319&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANIN DITA&quot;, nis: &quot;0143402086&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANISA SHAKILAH&quot;, nis: &quot;3166006738&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANNISA NURUL AINI&quot;, nis: &quot;3126797487&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ANNISAH SABILA&quot;, nis: &quot;0141894597&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AQILLA AYU KENZIA&quot;, nis: &quot;3137369360&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARIDHAH ZAHIRA&quot;, nis: &quot;3166770016&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARIF DZAKI&quot;, nis: &quot;3158368653&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARISTA ADINDA ZAHRA&quot;, nis: &quot;3165731254&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARKANA IBNU HAPIZ&quot;, nis: &quot;3186966980&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ARSAKHA FIRENDRA&quot;, nis: &quot;0163124882&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ASIMA RASYIDAH&quot;, nis: &quot;3171656903&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ASSYIFA WAROHMAH&quot;, nis: &quot;0145559875&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ASYIFA&quot;, nis: &quot;3132084012&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ATHIFAH NAJIBAH&quot;, nis: &quot;3141575137&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AYUDIA INARA&quot;, nis: &quot;3166989578&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZALEA RAMADANI&quot;, nis: &quot;3183666209&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZAM SAPUTRA&quot;, nis: &quot;3163535253&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKA AMANI&quot;, nis: &quot;3127394232&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKA NANDANA&quot;, nis: &quot;3171828078&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKADINA SYAHIRA&quot;, nis: &quot;3186616578&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZKIA FITRI&quot;, nis: &quot;0137269167&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZZAHDAN&quot;, nis: &quot;0147437017&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZZAHRA&quot;, nis: &quot;3164580221&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;AZZAHRA MALIKATUNNISA&quot;, nis: &quot;0142606608&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;BILQIS ADIBA&quot;, nis: &quot;3148467992&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DAHLIA SAFITRI&quot;, nis: &quot;0155421876&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DARYL GIBRAN&quot;, nis: &quot;3177105635&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DHAFI ALFARIZKI&quot;, nis: &quot;3189107763&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;DHIRA ERIANI EFENDI&quot;, nis: &quot;0136193837&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;EL HILAL&quot;, nis: &quot;0149878379&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FAJAR HIBATULLAH&quot;, nis: &quot;3147853995&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FAQIH AL-ARIF BILLAH&quot;, nis: &quot;0162980888&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FARID ABDULLAH&quot;, nis: &quot;3159849454&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FARID ATALLAH&quot;, nis: &quot;3173213699&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FATUR HAERYAN&quot;, nis: &quot;3189477950&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FEBRI YANTA&quot;, nis: &quot;0148382960&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIDIA ZAHIRA&quot;, nis: &quot;3175219013&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIKA APRILIA PUTERI&quot;, nis: &quot;3162193153&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIKRI&quot;, nis: &quot;3154327861&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIKRI ADITIYA ZAIDAN&quot;, nis: &quot;3176698051&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;FIRJATULLAH&quot;, nis: &quot;3170009430&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HABIBAH NUR AINI&quot;, nis: &quot;3156544031&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HADZIQ PIKRI&quot;, nis: &quot;3133282159&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HANA KHAIRUNNISA&quot;, nis: &quot;3152019771&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HAPIZA HOYIRO&quot;, nis: &quot;3150397264&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HESTYAN PUSPITA NINGRUM&quot;, nis: &quot;3176737868&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;HILYA QONITA&quot;, nis: &quot;3140539807&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ILDAH HIJRIAH&quot;, nis: &quot;3129581253&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ILONA WANIA ALSABA&quot;, nis: &quot;3182740868&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IMAM ALHAFID&quot;, nis: &quot;0161714082&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;INTAN AYU DISKA&quot;, nis: &quot;3170849022&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;INTAN MAHARANI&quot;, nis: &quot;3167437812&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IQBAL ARKAP&quot;, nis: &quot;3153337033&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IQBAL RAMADHAN&quot;, nis: &quot;0125999247&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IRFAN YUSRAN ADITYA&quot;, nis: &quot;0146514349&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;ISTIQOMAH&quot;, nis: &quot;0122591444&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IZATUNNISA&quot;, nis: &quot;3136662150&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;IZZAH URRUH&quot;, nis: &quot;0147611643&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;JANATAN FIRDAUS&quot;, nis: &quot;3178698209&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;JANEETA RAISSA&quot;, nis: &quot;0145100679&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KAYLA AFIFAH&quot;, nis: &quot;0135204738&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KAYLA SAPINA&quot;, nis: &quot;0134359075&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KENZIE ABDILLAH&quot;, nis: &quot;3161203638&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KEVIN AFFANDI&quot;, nis: &quot;3156543397&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KHOIRIL ANAM&quot;, nis: &quot;0123179238&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;KHOIRUNNISA&quot;, nis: &quot;3144391116&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;LIA ZAFIRA&quot;, nis: &quot;0122048375&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M IRZAH KHOIRULLAH&quot;, nis: &quot;0147327198&quot;, class: &quot;Kelas 3 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M RAFI MAULANA&quot;, nis: &quot;3171271070&quot;, class: &quot;Kelas 1 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ABID AUFA&quot;, nis: &quot;0149957978&quot;, class: &quot;Kelas 4 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. AKIL&quot;, nis: &quot;0133853164&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. AL HABSYI&quot;, nis: &quot;3179846316&quot;, class: &quot;Kelas 2 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ALBY FAHRI&quot;, nis: &quot;0142513224&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ALFAJRI&quot;, nis: &quot;0132059947&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. HABIBIE&quot;, nis: &quot;3154655615&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. Nahtor Nabil&quot;, nis: &quot;0132087512&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. NIZAM&quot;, nis: &quot;3165316803&quot;, class: &quot;Kelas 3 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. RAFA&quot;, nis: &quot;3165882318&quot;, class: &quot;Kelas 2 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. RAFFA ALFARIZQI&quot;, nis: &quot;3131445988&quot;, class: &quot;Kelas 6&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. RAFI RAFFASYA&quot;, nis: &quot;0155850169&quot;, class: &quot;Kelas 4 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. SAKHA ABDILLAH&quot;, nis: &quot;3133790004&quot;, class: &quot;Kelas 5 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M. ZHAFRAN KHAIRI&quot;, nis: &quot;0139386311&quot;, class: &quot;Kelas 5 A&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;M.IBNU ALNAFIS&quot;, nis: &quot;3179454907&quot;, class: &quot;Kelas 1 B&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ name: &quot;MAIRA AZZAH&quot;, nis: &quot;UNKNOWN_NIS_MAIRA&quot;, class: &quot;UNKNOWN_CLASS_MAIRA&quot; } // Placeholder for incomplete data</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;];</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Homeroom teacher data</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;const teachersData = [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 6&quot;, wali: &quot;Almuttahidin&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 5 A&quot;, wali: &quot;Risnawati&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 5 B&quot;, wali: &quot;Eny Marya&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 4 A&quot;, wali: &quot;Mariatul Kibtiya&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 4 B&quot;, wali: &quot;Zaharudin&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 3 A&quot;, wali: &quot;Siti Nursiyah&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 3 B&quot;, wali: &quot;Rita Ummatun&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 2 A&quot;, wali: &quot;Roziko&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 2 B&quot;, wali: &quot;Ambari&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 1 A&quot;, wali: &quot;Asniar&quot; },</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{ class: &quot;Kelas 1 B&quot;, wali: &quot;Marfuah&quot; }</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;];</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Get unique classes from student data and sort them</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.classes = [...new Set(studentsData.map(s =&gt; s.class))].sort();</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Initialize Firebase</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.addEventListener(&#39;load&#39;, async () =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const firebaseConfig = typeof __firebase_config !5= &#39;undefined&#39; ? JSON.parse(__firebase_config) : {};</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (Object.keys(firebaseConfig).length === 0) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Firebase config is missing. Please ensure __firebase_config is provided.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-message&#39;).textContent = &quot;Kesalahan: Konfigurasi Firebase tidak ditemukan. Aplikasi tidak dapat dimuat.&quot;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.firebaseApp = initializeApp(firebaseConfig);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.db = getFirestore(window.firebaseApp);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.auth = getAuth(window.firebaseApp);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Authenticate user</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (typeof __initial_auth_token !== &#39;undefined&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInWithCustomToken(window.auth, __initial_auth_token);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await signInAnonymously(window.auth);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Listen for auth state changes</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;onAuthStateChanged(window.auth, async (user) =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (user) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.currentUserId = user.uid;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;user-id-display&#39;).textContent = `ID Pengguna: ${window.currentUserId}`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.isAuthReady = true;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Firebase initialized and authenticated. User ID:&quot;, window.currentUserId);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await initAppData(); // Initialize app data (students, teachers) after auth</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showSection(&#39;attendance-input-section&#39;); // Show default section</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-overlay&#39;).classList.add(&#39;hidden&#39;); // Hide loading</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.currentUserId = null;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.isAuthReady = true;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;user-id-display&#39;).textContent = `ID Pengguna: Tidak Terautentikasi`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Firebase initialized, but no user authenticated.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-message&#39;).textContent = &quot;Kesalahan: Autentikasi Firebase gagal. Aplikasi tidak dapat dimuat.&quot;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error initializing Firebase:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;loading-message&#39;).textContent = `Kesalahan saat memulai aplikasi: ${error.message}.`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Function to initialize app data (students and teachers) in Firestore</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function initAppData() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!window.isAuthReady || !window.db) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.warn(&quot;Firebase not ready for data initialization.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsColRef = collection(window.db, `artifacts/${appId}/public/data/students`);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const teachersColRef = collection(window.db, `artifacts/${appId}/public/data/teachers`);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Check if students data exists, if not, add it</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsSnapshot = await getDocs(studentsColRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (studentsSnapshot.empty) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Adding initial student data to Firestore...&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const student of studentsData) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(doc(studentsColRef, student.nis), student);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Student data added.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Student data already exists in Firestore.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Check if teachers data exists, if not, add it</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const teachersSnapshot = await getDocs(teachersColRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (teachersSnapshot.empty) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Adding initial teacher data to Firestore...&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const teacher of teachersData) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(doc(teachersColRef, teacher.class), teacher);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Teacher data added.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.log(&quot;Teacher data already exists in Firestore.&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Load students and teachers into global variables for faster access</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.allStudents = studentsData; // Use the parsed data directly</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.allTeachers = teachersData; // Use the parsed data directly</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;populateClassDropdowns();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error initializing app data:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- UI Navigation Functions ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function showSection(sectionId) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;.app-section&#39;).forEach(section =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;section.classList.add(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(sectionId).classList.remove(&#39;hidden&#39;);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Update active navigation link</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;nav a&#39;).forEach(link =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.classList.remove(&#39;bg-blue-700&#39;, &#39;text-white&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;link.classList.add(&#39;text-blue-200&#39;, &#39;hover:bg-blue-600&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelector(`nav a[onclick=&quot;showSection(&#39;${sectionId}&#39;)&quot;]`).classList.remove(&#39;text-blue-200&#39;, &#39;hover:bg-blue-600&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelector(`nav a[onclick=&quot;showSection(&#39;${sectionId}&#39;)&quot;]`).classList.add(&#39;bg-blue-700&#39;, &#39;text-white&#39;);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Specific actions for sections</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (sectionId === &#39;recapitulation-section&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;renderRecap();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Attendance Input Logic ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function populateClassDropdowns() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const classSelect = document.getElementById(&#39;attendance-class-select&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recapClassSelect = document.getElementById(&#39;recap-class-select&#39;);</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;classSelect.innerHTML = &#39;</span><span class="c2 c6">&lt;</span><span class="c2 c5">option</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Kelas</span><span class="c2 c6">&lt;/</span><span class="c2 c5">option</span><span class="c2 c6">&gt;</span><span class="c4 c2">&#39;;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapClassSelect.innerHTML = &#39;</span><span class="c2 c6">&lt;</span><span class="c2 c5">option</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Semua Kelas</span><span class="c2 c6">&lt;/</span><span class="c2 c5">option</span><span class="c2 c6">&gt;</span><span class="c4 c2">&#39;; // For recapitulation, allow &quot;All Classes&quot;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;window.classes.forEach(cls =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const option = document.createElement(&#39;option&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;option.value = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;option.textContent = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;classSelect.appendChild(option);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recapOption = document.createElement(&#39;option&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapOption.value = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapOption.textContent = cls;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapClassSelect.appendChild(recapOption);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function loadStudentsForAttendance() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;attendance-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedDate = document.getElementById(&#39;attendance-date-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceTableBody = document.getElementById(&#39;attendance-table-body&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attendanceTableBody.innerHTML = &#39;&#39;; // Clear previous students</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedClass || !selectedDate) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsInClass = window.allStudents.filter(s =&gt; s.class === selectedClass);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocId = `${selectedDate}_${selectedClass.replace(/\s/g, &#39;_&#39;)}`; // Use underscore for class name in doc ID</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocRef = doc(window.db, `artifacts/${appId}/public/data/attendance`, attendanceDocId);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let existingAttendance = {};</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const docSnap = await getDoc(attendanceDocRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (docSnap.exists()) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;existingAttendance = docSnap.data().records.reduce((acc, rec) =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;acc[rec.nis] = rec.status;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return acc;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, {});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error fetching existing attendance:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentsInClass.forEach(student =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const row = document.createElement(&#39;tr&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.className = &#39;border-b border-gray-200&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const currentStatus = existingAttendance[student.nis] || &#39;Hadir&#39;; // Default to Hadir</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.innerHTML = `</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${student.name}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex items-center space-x-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Hadir&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-blue-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Hadir&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Hadir</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Sakit&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-yellow-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Sakit&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Sakit</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Izin&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-green-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Izin&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Izin</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;inline-flex items-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;radio&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">name</span><span class="c2 c6">=</span><span class="c0">&quot;status-${student.nis}&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">value</span><span class="c2 c6">=</span><span class="c0">&quot;Alpha&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;form-radio text-red-600 h-4 w-4&quot;</span><span class="c2">&nbsp;${</span><span class="c2 c9">currentStatus</span><span class="c2">&nbsp;</span><span class="c2 c6">===</span><span class="c2">&nbsp;</span><span class="c0">&#39;Alpha&#39;</span><span class="c2">&nbsp;? </span><span class="c0">&#39;checked&#39;</span><span class="c2">&nbsp;: </span><span class="c0">&#39;&#39;</span><span class="c2">}</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;ml-2 text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Alpha</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attendanceTableBody.appendChild(row);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;save-attendance-btn&#39;).classList.remove(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function saveAttendance() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;attendance-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedDate = document.getElementById(&#39;attendance-date-input&#39;).value;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedClass || !selectedDate) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Pilih kelas dan tanggal terlebih dahulu.&#39;, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c2 c4">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceRecords = [];</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsInClass = window.allStudents.filter(s =&gt; s.class === selectedClass);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentsInClass.forEach(student =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const statusElement = document.querySelector(`input[name=&quot;status-${student.nis}&quot;]:checked`);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (statusElement) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;attendanceRecords.push({</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nis: student.nis,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name: student.name, // Store name for easier lookup in reports</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;status: statusElement.value</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocId = `${selectedDate}_${selectedClass.replace(/\s/g, &#39;_&#39;)}`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceDocRef = doc(window.db, `artifacts/${appId}/public/data/attendance`, attendanceDocId);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await setDoc(attendanceDocRef, {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;date: selectedDate,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class: selectedClass,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;records: attendanceRecords</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Kehadiran berhasil disimpan!&#39;, &#39;success&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error saving attendance:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(`Gagal menyimpan kehadiran: ${error.message}`, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Recapitulation Logic ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;let myChart = null; // To store the Chart.js instance</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;async function renderRecap() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedMonthYear = document.getElementById(&#39;recap-month-year-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;recap-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recapTableBody = document.getElementById(&#39;recap-table-body&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const chartCanvas = document.getElementById(&#39;attendanceChart&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapTableBody.innerHTML = &#39;&#39;;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedMonthYear) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Pilih bulan dan tahun untuk rekapitulasi.&#39;, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const [year, month] = selectedMonthYear.split(&#39;-&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const firstDay = new Date(year, month - 1, 1);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const lastDay = new Date(year, month, 0); // Last day of the month</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const appId = typeof __app_id !== &#39;undefined&#39; ? __app_id : &#39;default-app-id&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const attendanceColRef = collection(window.db, `artifacts/${appId}/public/data/attendance`);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let allAttendanceRecords = [];</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const querySnapshot = await getDocs(attendanceColRef);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;querySnapshot.forEach(docSnap =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const data = docSnap.data();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const recordDate = new Date(data.date);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Filter by month and year</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (recordDate &gt;= firstDay &amp;&amp; recordDate </span><span class="c2 c6">&lt;</span><span class="c4 c2">= lastDay) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Filter by class if a specific class is selected</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!selectedClass || data.class === selectedClass) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;allAttendanceRecords.push(data);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;Error fetching recapitulation data:&quot;, error);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(`Gagal memuat data rekapitulasi: ${error.message}`, &#39;error&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Aggregate data</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentRecap = {}; // { nis: { name, class, Hadir: count, Sakit: count, Izin: count, Alpha: count } }</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Initialize studentRecap with all relevant students</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const studentsToProcess = selectedClass ?</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.allStudents.filter(s =&gt; s.class === selectedClass) :</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.allStudents;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentsToProcess.forEach(student =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentRecap[student.nis] = {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;name: student.name,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;class: student.class,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Hadir&#39;: 0,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Sakit&#39;: 0,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Izin&#39;: 0,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Alpha&#39;: 0</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;allAttendanceRecords.forEach(dailyRecord =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dailyRecord.records.forEach(studentDailyRecord =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (studentRecap[studentDailyRecord.nis]) { // Only count if student is in the processed list</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;studentRecap[studentDailyRecord.nis][studentDailyRecord.status]++;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Render table</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const nis in studentRecap) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const data = studentRecap[nis];</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const row = document.createElement(&#39;tr&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.className = &#39;border-b border-gray-200&#39;;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.innerHTML = `</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.name}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.class}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Hadir}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Sakit}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Izin}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">td</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">${data.Alpha}</span><span class="c2 c6">&lt;/</span><span class="c2 c5">td</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recapTableBody.appendChild(row);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Render chart</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;renderChart(studentRecap);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Enable download buttons</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;download-excel-btn&#39;).classList.remove(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&#39;download-csv-btn&#39;).classList.remove(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function renderChart(recapData) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const chartCanvas = document.getElementById(&#39;attendanceChart&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (myChart) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;myChart.destroy(); // Destroy existing chart before creating a new one</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const hadirCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Hadir, 0);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const sakitCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Sakit, 0);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const izinCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Izin, 0);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const alphaCount = Object.values(recapData).reduce((sum, student) =&gt; sum + student.Alpha, 0);</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;myChart = new Chart(chartCanvas, {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type: &#39;bar&#39;, // Can be &#39;bar&#39;, &#39;pie&#39;, &#39;doughnut&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;data: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;labels: [&#39;Hadir&#39;, &#39;Sakit&#39;, &#39;Izin&#39;, &#39;Alpha&#39;],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;datasets: [{</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;label: &#39;Jumlah Kehadiran&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;data: [hadirCount, sakitCount, izinCount, alphaCount],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;backgroundColor: [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(75, 192, 192, 0.6)&#39;, // Hadir</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 206, 86, 0.6)&#39;, // Sakit</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(54, 162, 235, 0.6)&#39;, // Izin</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 99, 132, 0.6)&#39; &nbsp;// Alpha</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;borderColor: [</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(75, 192, 192, 1)&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 206, 86, 1)&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(54, 162, 235, 1)&#39;,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;rgba(255, 99, 132, 1)&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;],</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;borderWidth: 1</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}]</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;options: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;responsive: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;maintainAspectRatio: false,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;scales: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;y: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;beginAtZero: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39;Jumlah Catatan Kehadiran&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;},</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;plugins: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;title: {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;display: true,</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text: &#39;Ringkasan Kehadiran Bulanan&#39;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Export Functions ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function exportToExcel() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedMonthYear = document.getElementById(&#39;recap-month-year-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;recap-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const filename = `Rekap_Kehadiran_SDN29Terusan_${selectedClass || &#39;SemuaKelas&#39;}_${selectedMonthYear}.xlsx`;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const table = document.getElementById(&#39;recap-table&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const ws = XLSX.utils.table_to_sheet(table);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const wb = XLSX.utils.book_new();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;XLSX.utils.book_append_sheet(wb, ws, &quot;Rekap Kehadiran&quot;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;XLSX.writeFile(wb, filename);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Laporan Excel berhasil diunduh!&#39;, &#39;success&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function exportToCSV() {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedMonthYear = document.getElementById(&#39;recap-month-year-input&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const selectedClass = document.getElementById(&#39;recap-class-select&#39;).value;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const filename = `Rekap_Kehadiran_SDN29Terusan_${selectedClass || &#39;SemuaKelas&#39;}_${selectedMonthYear}.csv`;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const table = document.getElementById(&#39;recap-table&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let csv = [];</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (let i = 0; i </span><span class="c2 c6">&lt;</span><span class="c4 c2">&nbsp;table.rows.length; i++) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let row = [], cols = table.rows[i].querySelectorAll(&#39;td, th&#39;);</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (let j = 0; j </span><span class="c2 c6">&lt;</span><span class="c4 c2">&nbsp;cols.length; j++) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;row.push(cols[j].innerText);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;csv.push(row.join(&#39;,&#39;));</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const csvFile = new Blob([csv.join(&#39;\n&#39;)], { type: &#39;text/csv;charset=utf-8;&#39; });</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const downloadLink = document.createElement(&#39;a&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;downloadLink.href = URL.createObjectURL(csvFile);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;downloadLink.download = filename;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.body.appendChild(downloadLink);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;downloadLink.click();</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.body.removeChild(downloadLink);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showMessage(&#39;Laporan CSV berhasil diunduh!&#39;, &#39;success&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// --- Message Box / Toast Notification ---</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;function showMessage(message, type) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const messageBox = document.getElementById(&#39;message-box&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.textContent = message;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.remove(&#39;hidden&#39;, &#39;bg-green-100&#39;, &#39;text-green-800&#39;, &#39;bg-red-100&#39;, &#39;text-red-800&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (type === &#39;success&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.add(&#39;bg-green-100&#39;, &#39;text-green-800&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else if (type === &#39;error&#39;) {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.add(&#39;bg-red-100&#39;, &#39;text-red-800&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;setTimeout(() =&gt; {</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;messageBox.classList.add(&#39;hidden&#39;);</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}, 3000); // Hide after 3 seconds</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;// Expose functions to global scope for HTML event handlers</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.showSection = showSection;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.loadStudentsForAttendance = loadStudentsForAttendance;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.saveAttendance = saveAttendance;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.renderRecap = renderRecap;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.exportToExcel = exportToExcel;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;window.exportToCSV = exportToCSV;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">script</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://cdn.jsdelivr.net/npm/chart.js&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">script</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">style</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">body</span><span class="c4 c2">&nbsp;{</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">font-family:</span><span class="c2">&nbsp;</span><span class="c2 c15">&#39;Inter&#39;</span><span class="c2">, </span><span class="c2 c11">sans-serif</span><span class="c4 c2">;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">/* Custom styles for better radio button alignment */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio</span><span class="c4 c2">&nbsp;{</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">-webkit-appearance:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">-moz-appearance:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">appearance:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">display:</span><span class="c2">&nbsp;</span><span class="c2 c11">inline-block</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">vertical-align:</span><span class="c2">&nbsp;</span><span class="c2 c11">middle</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-origin:</span><span class="c2">&nbsp;</span><span class="c2 c11">border-box</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">user-select:</span><span class="c2">&nbsp;</span><span class="c2 c11">none</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">flex-shrink:</span><span class="c2">&nbsp;</span><span class="c2 c12">0</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">border-radius:</span><span class="c2">&nbsp;</span><span class="c2 c12">100%</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">border-width:</span><span class="c2">&nbsp;</span><span class="c2 c12">1px</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">border-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#cbd5e0</span><span class="c2">; </span><span class="c10 c2">/* gray-300 */</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio:checked</span><span class="c4 c2">&nbsp;{</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-image:</span><span class="c2">&nbsp;</span><span class="c2 c11">url</span><span class="c2">(</span><span class="c2 c15">&quot;data:image/svg+xml,%3csvg viewBox=&#39;0 0 16 16&#39; fill=&#39;white&#39; xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3ccircle cx=&#39;8&#39; cy=&#39;8&#39; r=&#39;3&#39;/%3e%3c/svg%3e&quot;</span><span class="c4 c2">);</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-size:</span><span class="c2">&nbsp;</span><span class="c2 c12">100%</span><span class="c2">&nbsp;</span><span class="c2 c12">100%</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-position:</span><span class="c2">&nbsp;</span><span class="c2 c11">center</span><span class="c4 c2">;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c9">background-repeat:</span><span class="c2">&nbsp;</span><span class="c2 c11">no-repeat</span><span class="c4 c2">;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-blue-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#2563eb</span><span class="c2">; } </span><span class="c10 c2">/* blue-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-yellow-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#d97706</span><span class="c2">; } </span><span class="c10 c2">/* yellow-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-green-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#059669</span><span class="c2">; } </span><span class="c10 c2">/* green-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c5">.form-radio.text-red-600:checked</span><span class="c2">&nbsp;{ </span><span class="c2 c9">background-color:</span><span class="c2">&nbsp;</span><span class="c2 c11">#dc2626</span><span class="c2">; } </span><span class="c10 c2">/* red-600 */</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">style</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;/</span><span class="c2 c5">head</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;</span><span class="c2 c5">body</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-gray-100 text-gray-900 min-h-screen flex flex-col&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Loading Overlay --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;loading-overlay&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-white p-8 rounded-lg shadow-lg text-center&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent mx-auto mb-4&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">p</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;loading-message&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-lg font-semibold text-gray-700&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Memuat aplikasi...</span><span class="c2 c6">&lt;/</span><span class="c2 c5">p</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Message Box --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;message-box&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden fixed top-4 right-4 p-4 rounded-lg shadow-md text-sm font-medium z-40 transition-all duration-300 ease-in-out&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">header</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-800 text-white p-4 shadow-md flex items-center justify-between flex-wrap&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex items-center space-x-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">img</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://freeimghost.net/images/2025/06/13/MD-02-2.png&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">alt</span><span class="c2 c6">=</span><span class="c0">&quot;Logo SD Negeri 29 Terusan&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;h-12 w-12 rounded-full shadow-lg&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h1</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-2xl font-bold&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Sistem Informasi Kehadiran Pelajar Online (SIKEPO)</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h1</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-sm mt-2 md:mt-0&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;user-id-display&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">header</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex flex-1 flex-col md:flex-row&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Sidebar Navigation --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">nav</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-800 text-blue-200 w-full md:w-64 p-4 space-y-2 shadow-lg&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">a</span><span class="c2">&nbsp;</span><span class="c2 c9">href</span><span class="c2 c6">=</span><span class="c0">&quot;#&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;showSection(&#39;attendance-input-section&#39;)&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block p-3 rounded-lg hover:bg-blue-600 transition-colors duration-200 bg-blue-700 text-white&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Input Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">a</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">a</span><span class="c2">&nbsp;</span><span class="c2 c9">href</span><span class="c2 c6">=</span><span class="c0">&quot;#&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;showSection(&#39;recapitulation-section&#39;)&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block p-3 rounded-lg hover:bg-blue-600 transition-colors duration-200&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Rekapitulasi &amp; Laporan</span><span class="c2 c6">&lt;/</span><span class="c2 c5">a</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">nav</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Main Content Area --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">main</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex-1 p-6 bg-gray-50 overflow-auto&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Input Kehadiran Section --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">section</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-input-section&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;app-section bg-white p-6 rounded-lg shadow-xl mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h2</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-3xl font-semibold text-blue-800 mb-6&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Input Kehadiran Harian</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h2</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;grid grid-cols-1 md:grid-cols-2 gap-6 mb-6&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-date-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Tanggal:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;date&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-date-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;loadStudentsForAttendance()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Kelas:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">select</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;loadStudentsForAttendance()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Options will be populated by JavaScript --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">select</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;overflow-x-auto&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">table</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;min-w-full bg-white rounded-lg shadow-md&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">thead</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-100&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tl-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Nama Siswa</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tr-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Status Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">thead</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tbody</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendance-table-body&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Student rows will be loaded here --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tbody</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">table</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">button</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;save-attendance-btn&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;saveAttendance()&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden mt-6 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Simpan Kehadiran</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">button</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">section</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Rekapitulasi &amp; Laporan Section --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">section</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recapitulation-section&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;app-section hidden bg-white p-6 rounded-lg shadow-xl mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h2</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-3xl font-semibold text-blue-800 mb-6&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Rekapitulasi &amp; Laporan Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h2</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;grid grid-cols-1 md:grid-cols-2 gap-6 mb-6&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;recap-month-year-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Bulan &amp; Tahun:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">input</span><span class="c2">&nbsp;</span><span class="c2 c9">type</span><span class="c2 c6">=</span><span class="c0">&quot;month&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-month-year-input&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;renderRecap()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">label</span><span class="c2">&nbsp;</span><span class="c2 c9">for</span><span class="c2 c6">=</span><span class="c0">&quot;recap-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;block text-gray-700 text-sm font-bold mb-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Pilih Kelas:</span><span class="c2 c6">&lt;/</span><span class="c2 c5">label</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">select</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-class-select&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;shadow border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onchange</span><span class="c2 c6">=</span><span class="c0">&quot;renderRecap()&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Options will be populated by JavaScript --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">select</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;overflow-x-auto mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">table</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-table&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;min-w-full bg-white rounded-lg shadow-md&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">thead</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-blue-100&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tl-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Nama Siswa</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Kelas</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Hadir</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Sakit</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Izin</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">th</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;py-3 px-4 text-left text-sm font-semibold text-gray-700 uppercase tracking-wider rounded-tr-lg&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Alpha</span><span class="c2 c6">&lt;/</span><span class="c2 c5">th</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tr</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">thead</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">tbody</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;recap-table-body&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10 c2">&lt;!-- Recapitulation data will be loaded here --&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">tbody</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">table</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;mb-8&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">h3</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;text-2xl font-semibold text-blue-700 mb-4&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Grafik Kehadiran</span><span class="c2 c6">&lt;/</span><span class="c2 c5">h3</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;relative h-80&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">canvas</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;attendanceChart&quot;</span><span class="c2 c6">&gt;&lt;/</span><span class="c2 c5">canvas</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">div</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;flex flex-wrap gap-4&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">button</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;download-excel-btn&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;exportToExcel()&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-75&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Download Excel</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">button</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">button</span><span class="c2">&nbsp;</span><span class="c2 c9">id</span><span class="c2 c6">=</span><span class="c0">&quot;download-csv-btn&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">onclick</span><span class="c2 c6">=</span><span class="c0">&quot;exportToCSV()&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;hidden bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-75&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c4 c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Download Spreadsheet (CSV)</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">button</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">section</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">main</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; </span><span class="c2 c6">=</span><span class="c0">&quot;Logo Gena Belajar&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;h-8 w-auto&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">footer</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2 c6">&lt;/</span><span class="c2 c5">body</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;/</span><span class="c2 c5">html</span><span class="c2 c6">&gt;</span><span class="c2">&nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">div</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">footer</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;bg-gray-800 text-gray-300 p-4 text-center text-sm flex items-center justify-center flex-wrap&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">span</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;mr-2&quot;</span><span class="c2 c6">&gt;</span><span class="c2">Powered by. Gena Belajar</span><span class="c2 c6">&lt;/</span><span class="c2 c5">span</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c2 c6">&lt;</span><span class="c2 c5">img</span><span class="c2">&nbsp;</span><span class="c2 c9">src</span><span class="c2 c6">=</span><span class="c0">&quot;https://freeimghost.net/images/2025/06/17/Logo-Gena-Belajar.png&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">alt</span><span class="c2 c6">=</span><span class="c0">&quot;Logo Gena Belajar&quot;</span><span class="c2">&nbsp;</span><span class="c2 c9">class</span><span class="c2 c6">=</span><span class="c0">&quot;h-8 w-auto&quot;</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2">&nbsp; &nbsp;</span><span class="c2 c6">&lt;/</span><span class="c2 c5">footer</span><span class="c3 c2">&gt;</span></p><p class="c1 c7"><span class="c4 c2"></span></p><p class="c1"><span class="c2 c6">&lt;/</span><span class="c2 c5">body</span><span class="c3 c2">&gt;</span></p><p class="c1"><span class="c2 c6">&lt;/</span><span class="c2 c5">html</span><span class="c2 c6">&gt;</span></p><p class="c19 c7"><span class="c4 c13"></span></p></body></html>